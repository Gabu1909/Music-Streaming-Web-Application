import{_ as y,g as m,u as h,h as u,k as b,I as _,c as a,a as s,J as x,f as k,t as w,b as g,F,q as S,o,l as A}from"./index-BH3AGQtF.js";import{S as I}from"./SongItem-CwB0AvEh.js";const N={class:"favorites"},P={class:"container py-6"},T={key:0,class:"text-center py-6"},V={key:1,class:"alert alert-danger text-center rounded-3 shadow-sm",role:"alert"},B={key:2,class:"text-center py-6"},C={key:3,class:"favorites-list row g-4"},E={class:"favorite-item card h-100 shadow-sm"},L={__name:"Favorites",setup(D){const i=m(),v=h(),{userId:n}=v,r=u(!0),l=u(null);console.log("Auth object:",v);const d=async()=>{try{if(r.value=!0,l.value=null,!n.value)throw l.value="Please log in to view your favorites.",new Error("User not logged in");const e=await i.loadFavorites();if(!e||!e.data||!Array.isArray(e.data))throw new Error("Invalid data from server")}catch(e){l.value=e.message||"Failed to load favorites.",console.error("Fetch favorites error:",e)}finally{r.value=!1}},f=e=>{i.playSong(e)},p=e=>{if(!n.value){l.value="Please log in to toggle favorites.";return}i.toggleFavorite(e.song_id)};return b(()=>{console.log("userId on mount:",n.value),n.value?d():(r.value=!1,l.value="Please log in to view your favorites.")}),_(()=>n.value,e=>{console.log("userId changed to:",e),e&&d()}),(e,t)=>(o(),a("div",N,[s("div",P,[t[4]||(t[4]=x('<div class="text-center mb-6" data-v-7ae7ed54><h1 class="display-3 fw-bold text-white position-relative" data-v-7ae7ed54><i class="bi bi-heart-fill text-danger me-3" data-v-7ae7ed54></i><span class="title-text" data-v-7ae7ed54>Favorite Songs</span><div class="underline" data-v-7ae7ed54></div></h1><p class="lead text-light opacity-80 mt-2" data-v-7ae7ed54>A collection of your favorite tunes</p></div>',1)),r.value?(o(),a("div",T,t[1]||(t[1]=[s("div",{class:"spinner-container"},[s("div",{class:"spinner"})],-1),s("p",{class:"text-light mt-4 fs-5"},"Loading favorites...",-1)]))):l.value?(o(),a("div",V,[t[2]||(t[2]=s("i",{class:"bi bi-exclamation-circle me-2"},null,-1)),k(w(l.value)+" ",1),l.value.includes("logged in")?(o(),a("button",{key:0,class:"btn btn-danger ms-3 py-1",onClick:t[0]||(t[0]=c=>e.$router.push("/login"))},"Login")):(o(),a("button",{key:1,class:"btn btn-warning ms-3 py-1",onClick:d},"Try Again"))])):g(i).favorites.length===0?(o(),a("div",B,t[3]||(t[3]=[s("i",{class:"bi bi-music-note-list display-1 text-light opacity-50"},null,-1),s("p",{class:"text-light mt-3 fs-4"},"No favorite songs yet. Add some!",-1),s("a",{href:"/",class:"btn btn-outline-light mt-3 px-4 py-2"},"Discover Songs",-1)]))):(o(),a("div",C,[(o(!0),a(F,null,S(g(i).favorites,c=>(o(),a("div",{key:c.id,class:"col-12 col-md-6 col-lg-4"},[s("div",E,[A(I,{song:c,onSongClick:f,onToggleFavorite:p},null,8,["song"])])]))),128))]))])]))}},q=y(L,[["__scopeId","data-v-7ae7ed54"]]);export{q as default};
