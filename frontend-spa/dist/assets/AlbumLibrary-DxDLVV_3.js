import{_ as F,g as Q,s as q,h as L,x as S,j as f,c as o,a as s,e as N,v as V,b as n,t as v,d as P,F as y,q as _,y as B,z as R,o as a,l as h}from"./index-BH3AGQtF.js";import{A as k}from"./AlbumCard-BOcrsBrV.js";import{a as T}from"./album.service-aiTHCnAB.js";const z={class:"album-library-view container-fluid"},E={class:"library-header row align-items-center mb-4"},I={class:"col-md-6"},M={class:"search-controls d-flex"},O={key:0,class:"row justify-content-center py-5"},Z={key:1,class:"row justify-content-center py-5"},H={class:"col-12 col-md-8 text-center"},K={class:"error-message"},W={class:"my-2"},G={key:2},J={key:0,class:"mb-5"},X={class:"row row-cols-2 row-cols-sm-3 row-cols-md-4 row-cols-lg-5 row-cols-xl-6 g-3"},Y={key:1,class:"mb-5"},tt={class:"row row-cols-2 row-cols-sm-3 row-cols-md-4 row-cols-lg-5 row-cols-xl-6 g-3"},et={key:2},st={class:"row align-items-center mb-3"},lt={class:"col-md-6 d-flex justify-content-md-end align-items-center"},ot={class:"album-count me-3"},at=["value"],rt={key:0,class:"row row-cols-2 row-cols-sm-3 row-cols-md-4 row-cols-lg-5 row-cols-xl-6 g-3"},nt={key:1,class:"row justify-content-center py-5"},it={key:3,class:"row justify-content-center py-5"},ct={__name:"AlbumLibrary",setup(ut){const U=R(),b=Q(),A=q(),c=L(""),p=L("recent"),j=[{value:"recent",label:"Recently Added"},{value:"title-asc",label:"Title (A-Z)"},{value:"title-desc",label:"Title (Z-A)"}],{data:u,isLoading:$,error:C,refetch:d}=S({queryKey:["albums"],queryFn:async()=>(await T.getAllAlbums()).data.albums.map(t=>({...t,artist_name:t.artist_name||"Unknown Artist"}))||[],onError:l=>{console.error("Failed to fetch albums:",l)}}),m=f(()=>{let l=[...u.value||[]];if(c.value){const t=c.value.toLowerCase();l=l.filter(e=>e.title.toLowerCase().includes(t)||e.artist_name&&e.artist_name.toLowerCase().includes(t))}switch(p.value){case"title-asc":return l.sort((t,e)=>t.title.localeCompare(e.title));case"title-desc":return l.sort((t,e)=>e.title.localeCompare(t.title));case"recent":default:return l.sort((t,e)=>new Date(e.created_at||0)-new Date(t.created_at||0))}}),x=f(()=>[...u.value||[]].sort((l,t)=>new Date(t.created_at||0)-new Date(l.created_at||0)).slice(0,6)),D=f(()=>[...u.value||[]].sort((l,t)=>(t.play_count||0)-(l.play_count||0)).slice(0,6));async function w(l){try{const t=await T.getAlbumDetails(l),e=t.songs||[];if(e.length){const r=e.map(i=>({...i,id:i.song_id||i.id,audio_url:i.audio_url||"",artist:i.artist||t.artist_name||"Unknown Artist"}));b.setCurrentTrack(r[0]),b.setQueue(r),b.play()}else console.error("No songs found in album"),A.setQueryData(["albums","error"],"No songs available in this album.")}catch(t){console.error("Failed to play album:",t),A.setQueryData(["albums","error"],"Failed to play album. Please try again.")}}function g(l){U.push(`/albums/${l}`)}return(l,t)=>(a(),o("div",z,[s("div",E,[t[5]||(t[5]=s("div",{class:"col-md-6"},[s("h1",{class:"hero-title"},"Albums Hub"),s("p",{class:"hero-subtitle"},"Where every album tells a story")],-1)),s("div",I,[s("div",M,[N(s("input",{type:"text",placeholder:"Search albums...",class:"search-input","onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e)},null,512),[[V,c.value]]),s("button",{class:"refresh-button btn ms-2",onClick:t[1]||(t[1]=(...e)=>n(d)&&n(d)(...e))},t[4]||(t[4]=[s("i",{class:"fa fa-search"},null,-1)]))])])]),n($)?(a(),o("div",O,t[6]||(t[6]=[s("div",{class:"col-12 text-center"},[s("div",{class:"loading-spinner"}),s("div",{class:"loading-text"},"Loading albums...")],-1)]))):n(C)?(a(),o("div",Z,[s("div",H,[s("div",K,[t[7]||(t[7]=s("i",{class:"bi bi-exclamation-circle-fill"},null,-1)),s("div",W,v(n(C).message),1),s("button",{class:"retry-button btn",onClick:t[2]||(t[2]=(...e)=>n(d)&&n(d)(...e))},"Try Again")])])])):(a(),o("div",G,[x.value.length?(a(),o("section",J,[t[8]||(t[8]=s("div",{class:"row mb-3"},[s("div",{class:"col"},[s("h2",{class:"section-title"},"New Releases")])],-1)),s("div",X,[(a(!0),o(y,null,_(x.value,e=>(a(),o("div",{class:"col",key:"new-"+e.album_id},[h(k,{title:e.title,artist:e.artist_name||"Unknown Artist",cover_url:e.cover_url,songData:{},onClick:r=>g(e.album_id),onPlay:r=>w(e.album_id)},null,8,["title","artist","cover_url","onClick","onPlay"])]))),128))])])):P("",!0),D.value.length?(a(),o("section",Y,[t[9]||(t[9]=s("div",{class:"row mb-3"},[s("div",{class:"col"},[s("h2",{class:"section-title"},"Top Albums")])],-1)),s("div",tt,[(a(!0),o(y,null,_(D.value,e=>(a(),o("div",{class:"col",key:"top-"+e.album_id},[h(k,{title:e.title,artist:e.artist_name||"Unknown Artist",cover_url:e.cover_url,songData:{},play_count:e.play_count,onClick:r=>g(e.album_id),onPlay:r=>w(e.album_id)},null,8,["title","artist","cover_url","play_count","onClick","onPlay"])]))),128))])])):P("",!0),n(u).length?(a(),o("section",et,[s("div",st,[t[10]||(t[10]=s("div",{class:"col-md-6"},[s("h2",{class:"section-title"},"All Albums")],-1)),s("div",lt,[s("div",ot,v(m.value.length)+" "+v(m.value.length===1?"album":"albums"),1),N(s("select",{class:"sort-select form-select","onUpdate:modelValue":t[3]||(t[3]=e=>p.value=e),style:{width:"auto"}},[(a(),o(y,null,_(j,e=>s("option",{value:e.value,key:e.value},v(e.label),9,at)),64))],512),[[B,p.value]])])]),m.value.length?(a(),o("div",rt,[(a(!0),o(y,null,_(m.value,e=>(a(),o("div",{class:"col",key:e.album_id},[h(k,{title:e.title,artist:e.artist_name||"Unknown Artist",cover_url:e.cover_url,songData:{},onClick:r=>g(e.album_id),onPlay:r=>w(e.album_id)},null,8,["title","artist","cover_url","onClick","onPlay"])]))),128))])):(a(),o("div",nt,t[11]||(t[11]=[s("div",{class:"col-12 text-center"},[s("div",{class:"no-results-message"},[s("i",{class:"bi bi-search"}),s("h3",null,"No albums found"),s("p",null,"Try adjusting your search or filter criteria")])],-1)])))])):(a(),o("div",it,t[12]||(t[12]=[s("div",{class:"col-12 col-md-8 text-center"},[s("div",{class:"empty-state"},[s("i",{class:"bi bi-collection"}),s("h3",null,"No albums found"),s("p",null,"It seems you don't have any albums yet."),s("button",{class:"action-button btn"},"Upload Album")])],-1)])))]))]))}},yt=F(ct,[["__scopeId","data-v-1f4601f8"]]);export{yt as default};
