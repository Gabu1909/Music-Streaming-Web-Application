import{K as c,g as h,x as v,_ as P,h as S,c as C,o as D,a as l,e as E,L as _,w as b,t as m,z as N}from"./index-DTmEoMLP.js";/* empty css                                                                     */const T={async getAllPlaylists(){return await c("/api/playlists",{method:"GET"})},async getPlaylistDetails(a){return await c(`/api/playlists/${a}`,{method:"GET"})},async createPlaylist(a){return await c("/api/playlists",{method:"POST",body:a})},async uploadCover(a){const e=new FormData;return e.append("cover",a),await c("/api/upload/playlist-cover",{method:"POST",body:e})},async updatePlaylist(a,e){return await c(`/api/playlists/${a}`,{method:"PUT",body:e})},async deletePlaylist(a){return await c(`/api/playlists/${a}`,{method:"DELETE"})}};function k(a){const e=h(),o="uploads/img/default-playlist.png",{data:y,isLoading:d,error:u,refetch:p}=v({queryKey:["playlist",a],queryFn:async()=>{if(!a||isNaN(a))throw new Error("Invalid playlist ID");const n=await T.getPlaylistDetails(a);if(!n||n.status==="fail")throw new Error(n?.message||"Playlist not found");const t=n?.data?.data;if(!t||typeof t!="object")throw new Error("Invalid playlist data");const g=await Promise.all((t.songs||[]).map(async i=>await e.normalizeSongData({id:i.song_id,...i})));return{...t,id:t.playlist_id||t.id,song_count:t.song_count||t.songs?.length||0,image:t.image_url||o,songs:g.filter(i=>i)}},enabled:!!a});return{playlist:y,isLoading:d,error:u,refetch:p}}const z={class:"playlist-image"},$=["src","alt"],x={class:"playlist-info"},B={class:"playlist-title"},F={class:"song-count"},f="/uploads/img/default-playlist.png",I={__name:"PlaylistCard",props:{id:[Number,String],name:String,image:String,songCount:Number},emits:["play"],setup(a,{emit:e}){const o=a,y=e,d=S(!1),u=N(),{playSong:p}=h(),{refetch:n}=k(o.id),t=()=>{if(!o.id){console.warn("PlaylistCard: missing id prop");return}u.push({name:"playlist-detail",params:{id:o.id.toString()}}).catch(console.error)},g=async()=>{try{const s=(await n())?.data;if(console.log("Playlist data after refetch:",s),!s?.songs?.length){console.warn("No songs found in playlist");return}await p(s.songs[0],s.songs),y("play",o.id)}catch(r){console.error("Failed to play playlist:",r)}},i=r=>{r.target.src=f};return(r,s)=>(D(),C("div",{class:"playlist-card",onClick:t,onMouseenter:s[0]||(s[0]=w=>d.value=!0),onMouseleave:s[1]||(s[1]=w=>d.value=!1)},[l("div",z,[l("img",{src:a.image||f,alt:a.name,onError:i},null,40,$),E(l("button",{class:"play-btn",onClick:b(g,["stop"])},s[2]||(s[2]=[l("i",{class:"fas fa-play"},null,-1)]),512),[[_,d.value]])]),l("div",x,[l("h3",B,m(a.name),1),l("p",F,m(a.songCount)+" song"+m(a.songCount!==1?"s":""),1)])],32))}},q=P(I,[["__scopeId","data-v-80189dd6"]]);export{q as P,T as p,k as u};
