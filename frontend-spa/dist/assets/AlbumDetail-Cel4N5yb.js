import{_ as T,h as R,g as U,x as g,A as V,k as q,B as E,c as n,a as t,f as L,b as e,t as N,m as M,d as $,l as _,z as K,o,P as j}from"./index-CFB-G1Nn.js";import{a as f}from"./album.service-VUNTzvoJ.js";import{_ as z}from"./TrackList-BXYnJ8oV.js";import{A as I}from"./AlbumCard-ByEIF89c.js";const Q={class:"album-detail"},G={key:0,class:"loading"},H={key:1,class:"error"},J={key:2,class:"album-container"},O={class:"album-header"},W={class:"album-content"},X={__name:"AlbumDetail",setup(Y){const k=K(),r=V(),i=R(null),{currentSong:v,initAudio:h,playSong:u}=U(),{data:l,isLoading:A,error:d,refetch:S}=g({queryKey:["album",r.params.id],queryFn:async()=>(await f.getAlbumDetails(r.params.id)).data?.album||{},onError:a=>{console.error("Failed to fetch album details:",a)}}),{data:c,isLoading:w,error:m,refetch:x}=g({queryKey:["albumSongs",r.params.id],queryFn:async()=>(await f.getAlbumSongs(r.params.id)).data?.songs||[],onError:a=>{console.error("Failed to fetch album songs:",a)}}),B=()=>{k.back()},P=a=>a?`/${a.replace(/^public\//,"")}`:"/default-album.jpg",p=a=>a.audio_url?`/${a.audio_url.replace(/^public\//,"")}`:"",b=async()=>{const a=(c.value||[]).map(s=>({...s,audioUrl:p(s)}));a.length&&await u(a[0],a)},C=async a=>{const s=(c.value||[]).map(y=>({...y,audioUrl:p(y)}));await u(a,s)},D=a=>{console.log("Track options:",a)},F=async()=>{await Promise.all([S(),x()])};return q(async()=>{await E(),i.value&&h(i.value)}),(a,s)=>(o(),n("div",Q,[t("button",{class:"back-btn",onClick:B},s[0]||(s[0]=[t("i",{class:"fas fa-arrow-left"},null,-1),L(" Back ")])),e(A)||e(w)?(o(),n("div",G,s[1]||(s[1]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading album details...",-1)]))):e(d)||e(m)?(o(),n("div",H,[t("p",null,N(e(d)?.message||e(m)?.message||"Failed to load album data"),1),t("button",{onClick:F,class:"retry-btn"},"Retry")])):(o(),n("div",J,[t("div",O,[_(I,{title:e(l).title||"Untitled Album",artist:e(l).artist_name||"Unknown Artist",cover_url:P(e(l).cover_url),songData:e(l).songs,onClick:b,onPlay:b},null,8,["title","artist","cover_url","songData"])]),t("div",W,[s[2]||(s[2]=t("h2",{class:"text-light"},"Tracks",-1)),_(z,{tracks:e(c)||[],onMore:D,onPlay:C},null,8,["tracks"])]),t("audio",{ref_key:"audioRef",ref:i,preload:"metadata"},null,512),e(v)?(o(),M(j,{key:0})):$("",!0)]))]))}},ta=T(X,[["__scopeId","data-v-3bca6f82"]]);export{ta as default};
