import{_ as y,u as m,L as h,b as f,e as b,I as _,c as s,a,O as x,h as k,t as w,g as u,F,k as S,o,f as A}from"./index-CJw3wfj_.js";import{S as I}from"./SongItem-DS3YqNnt.js";const N={class:"favorites"},P={class:"container py-6"},L={key:0,class:"text-center py-6"},T={key:1,class:"alert alert-danger text-center rounded-3 shadow-sm",role:"alert"},V={key:2,class:"text-center py-6"},B={key:3,class:"favorites-list row g-4"},C={class:"favorite-item card h-100 shadow-sm"},E={__name:"Favorites",setup($){const r=m(),v=h(),{userId:i}=v,n=f(!0),l=f(null);console.log("Auth object:",v);const d=async()=>{try{if(n.value=!0,l.value=null,!i.value)throw l.value="Please log in to view your favorites.",new Error("User not logged in");const e=await r.loadFavorites(i.value);if(!e||!e.data||!Array.isArray(e.data))throw new Error("Invalid data from server");r.state.favorites=e.data}catch(e){l.value=e.message||"Failed to load favorites.",console.error("Fetch favorites error:",e)}finally{n.value=!1}},g=e=>{r.playSong(e)},p=e=>{if(!i.value){l.value="Please log in to toggle favorites.";return}r.toggleFavorite(e.song_id,!e.isFavorite,i.value)};return b(()=>{console.log("userId on mount:",i.value),i.value?d():(n.value=!1,l.value="Please log in to view your favorites.")}),_(()=>i.value,e=>{console.log("userId changed to:",e),e&&d()}),(e,t)=>(o(),s("div",N,[a("div",P,[t[4]||(t[4]=x('<div class="text-center mb-6" data-v-1ff3d6fd><h1 class="display-3 fw-bold text-white position-relative" data-v-1ff3d6fd><i class="bi bi-heart-fill text-danger me-3" data-v-1ff3d6fd></i><span class="title-text" data-v-1ff3d6fd>Favorite Songs</span><div class="underline" data-v-1ff3d6fd></div></h1><p class="lead text-light opacity-80 mt-2" data-v-1ff3d6fd>A collection of your favorite tunes</p></div>',1)),n.value?(o(),s("div",L,t[1]||(t[1]=[a("div",{class:"spinner-container"},[a("div",{class:"spinner"})],-1),a("p",{class:"text-light mt-4 fs-5"},"Loading favorites...",-1)]))):l.value?(o(),s("div",T,[t[2]||(t[2]=a("i",{class:"bi bi-exclamation-circle me-2"},null,-1)),k(w(l.value)+" ",1),l.value.includes("logged in")?(o(),s("button",{key:0,class:"btn btn-danger ms-3 py-1",onClick:t[0]||(t[0]=c=>e.$router.push("/login"))},"Login")):(o(),s("button",{key:1,class:"btn btn-warning ms-3 py-1",onClick:d},"Try Again"))])):u(r).favorites.length===0?(o(),s("div",V,t[3]||(t[3]=[a("i",{class:"bi bi-music-note-list display-1 text-light opacity-50"},null,-1),a("p",{class:"text-light mt-3 fs-4"},"No favorite songs yet. Add some!",-1),a("a",{href:"/discover",class:"btn btn-outline-light mt-3 px-4 py-2"},"Discover Songs",-1)]))):(o(),s("div",B,[(o(!0),s(F,null,S(u(r).favorites,c=>(o(),s("div",{key:c?.song_id,class:"col-12 col-md-6 col-lg-4"},[a("div",C,[A(I,{song:c,onSongClick:g,onToggleFavorite:p},null,8,["song"])])]))),128))]))])]))}},M=y(E,[["__scopeId","data-v-1ff3d6fd"]]);export{M as default};
