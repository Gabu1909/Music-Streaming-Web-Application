import{K as d,g as h,x as P,_ as v,h as E,c as S,o as C,a as e,e as _,L as D,w as b,t as m,z as N}from"./index-CFB-G1Nn.js";/* empty css                                                                     */const k={async getAllPlaylists(){return await d("/api/playlists",{method:"GET"})},async getPlaylistDetails(a){return await d(`/api/playlists/${a}`,{method:"GET"})},async createPlaylist(a){return await d("/api/playlists",{method:"POST",body:a,headers:{}})},async updatePlaylist(a,r){return await d(`/api/playlists/${a}`,{method:"PUT",body:r})},async deletePlaylist(a){return await d(`/api/playlists/${a}`,{method:"DELETE"})}};function z(a){const r=h(),l="uploads/img/default-playlist.png",{data:y,isLoading:c,error:u,refetch:p}=P({queryKey:["playlist",a],queryFn:async()=>{if(!a||isNaN(a))throw new Error("Invalid playlist ID");const n=await k.getPlaylistDetails(a);if(!n||n.status==="fail")throw new Error(n?.message||"Playlist not found");const t=n?.data?.data;if(!t||typeof t!="object")throw new Error("Invalid playlist data");const g=await Promise.all((t.songs||[]).map(async o=>await r.normalizeSongData({id:o.song_id,...o})));return{...t,id:t.playlist_id||t.id,song_count:t.song_count||t.songs?.length||0,image:t.image_url||l,songs:g.filter(o=>o)}},enabled:!!a});return{playlist:y,isLoading:c,error:u,refetch:p}}const T={class:"playlist-image"},$=["src","alt"],x={class:"playlist-info"},B={class:"playlist-title"},I={class:"song-count"},f="/uploads/img/default-playlist.png",L={__name:"PlaylistCard",props:{id:[Number,String],name:String,image:String,songCount:Number},emits:["play"],setup(a,{emit:r}){const l=a,y=r,c=E(!1),u=N(),{playSong:p}=h(),{refetch:n}=z(l.id),t=()=>{if(!l.id){console.warn("PlaylistCard: missing id prop");return}u.push({name:"playlist-detail",params:{id:l.id.toString()}}).catch(console.error)},g=async()=>{try{const s=(await n())?.data;if(console.log("Playlist data after refetch:",s),!s?.songs?.length){console.warn("No songs found in playlist");return}await p(s.songs[0],s.songs),y("play",l.id)}catch(i){console.error("Failed to play playlist:",i)}},o=i=>{i.target.src=f};return(i,s)=>(C(),S("div",{class:"playlist-card",onClick:t,onMouseenter:s[0]||(s[0]=w=>c.value=!0),onMouseleave:s[1]||(s[1]=w=>c.value=!1)},[e("div",T,[e("img",{src:a.image||f,alt:a.name,onError:o},null,40,$),_(e("button",{class:"play-btn",onClick:b(g,["stop"])},s[2]||(s[2]=[e("i",{class:"fas fa-play"},null,-1)]),512),[[D,c.value]])]),e("div",x,[e("h3",B,m(a.name),1),e("p",I,m(a.songCount)+" song"+m(a.songCount!==1?"s":""),1)])],32))}},F=v(L,[["__scopeId","data-v-80189dd6"]]);export{F as P,k as p,z as u};
